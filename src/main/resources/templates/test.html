<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§ˆì»¤ í‘œì‹œ ë¬¸ì œ ì§„ë‹¨</title>
    <style>
        body {
            font-family: 'Noto Sans KR', system-ui, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .debug-panel {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        .check-item {
            margin: 15px 0;
            padding: 15px;
            border-radius: 8px;
            background: #f8f9fa;
            border-left: 4px solid #667eea;
        }
        .status {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        .status.ok { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.warning { background: #fff3cd; color: #856404; }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s ease;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }
        .result {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin: 10px 0;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
            font-size: 12px;
        }
        .solution {
            background: #e7f3ff;
            border: 1px solid #b3d9ff;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        .urgent {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
        }
        h1, h2 {
            color: #2d3748;
        }
    </style>
</head>
<body>
<h1>ğŸ¯ ë§ˆì»¤ í‘œì‹œ ë¬¸ì œ ì§„ë‹¨</h1>

<div class="urgent">
    <strong>ğŸš¨ ë¹ ë¥¸ ì²´í¬:</strong> ë¸Œë¼ìš°ì € ê°œë°œìë„êµ¬(F12)ë¥¼ ì—´ê³  Console íƒ­ì—ì„œ ì˜¤ë¥˜ ë©”ì‹œì§€ê°€ ìˆëŠ”ì§€ ë¨¼ì € í™•ì¸í•´ë³´ì„¸ìš”!
</div>

<div class="debug-panel">
    <h2>1ï¸âƒ£ locations ë°ì´í„° ê²€ì¦</h2>
    <button onclick="checkLocationsData()">locations ë°ì´í„° í™•ì¸</button>
    <div id="locations-check" class="result" style="display:none;"></div>
</div>

<div class="debug-panel">
    <h2>2ï¸âƒ£ ì¢Œí‘œê°’ ìœ íš¨ì„± ê²€ì‚¬</h2>
    <button onclick="checkCoordinates()">ì¢Œí‘œê°’ ê²€ì¦</button>
    <div id="coordinates-check" class="result" style="display:none;"></div>
</div>

<div class="debug-panel">
    <h2>3ï¸âƒ£ ë§ˆì»¤ ìƒì„± ê³¼ì • ì¶”ì </h2>
    <button onclick="traceMarkerCreation()">ë§ˆì»¤ ìƒì„± ê³¼ì • ì¶”ì </button>
    <div id="marker-trace" class="result" style="display:none;"></div>
</div>

<div class="debug-panel">
    <h2>4ï¸âƒ£ ì§€ë„ ë²”ìœ„ ë° ì¤Œ ë ˆë²¨ í™•ì¸</h2>
    <button onclick="checkMapBounds()">ì§€ë„ ë²”ìœ„ í™•ì¸</button>
    <div id="bounds-check" class="result" style="display:none;"></div>
</div>

<div class="debug-panel">
    <h2>5ï¸âƒ£ í…ŒìŠ¤íŠ¸ ë§ˆì»¤ ìƒì„±</h2>
    <button onclick="createTestMarker()">í…ŒìŠ¤íŠ¸ ë§ˆì»¤ ìƒì„±</button>
    <button onclick="clearTestMarkers()">í…ŒìŠ¤íŠ¸ ë§ˆì»¤ ì œê±°</button>
    <div id="test-marker-result" class="result" style="display:none;"></div>
</div>

<div class="debug-panel">
    <h2>ğŸ”§ í•´ê²° ë°©ì•ˆ</h2>
    <div id="solutions"></div>
</div>

<script>
    let testMarkers = [];

    function checkLocationsData() {
        const result = document.getElementById('locations-check');
        result.style.display = 'block';

        try {
            // locations ë³€ìˆ˜ê°€ ì¡´ì¬í•˜ëŠ”ì§€ í™•ì¸
            if (typeof locations === 'undefined') {
                result.innerHTML = `âŒ ERROR: locations ë³€ìˆ˜ê°€ ì •ì˜ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!

í•´ê²°ë°©ë²•:
1. HTMLì—ì„œ Thymeleaf ìŠ¤í¬ë¦½íŠ¸ ë¶€ë¶„ í™•ì¸
2. ì„œë²„ì—ì„œ locations ë°ì´í„°ê°€ ì œëŒ€ë¡œ ì „ë‹¬ë˜ëŠ”ì§€ í™•ì¸
3. ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© ìˆœì„œ í™•ì¸`;
                return;
            }

            result.innerHTML = `âœ… locations ë³€ìˆ˜ ì¡´ì¬
ğŸ“Š ë°ì´í„° ê°œìˆ˜: ${locations.length}ê°œ

ìƒì„¸ ë°ì´í„°:
${JSON.stringify(locations, null, 2)}`;

            if (locations.length === 0) {
                result.innerHTML += `\n\nâš ï¸ WARNING: locations ë°°ì—´ì´ ë¹„ì–´ìˆìŠµë‹ˆë‹¤!
- ë°ì´í„°ë² ì´ìŠ¤ì— ë°ì´í„°ê°€ ìˆëŠ”ì§€ í™•ì¸
- ì„œë²„ì—ì„œ ë°ì´í„°ë¥¼ ì œëŒ€ë¡œ ì „ë‹¬í•˜ëŠ”ì§€ í™•ì¸
- activate í•„ë“œê°€ trueì¸ì§€ í™•ì¸`;
            }

        } catch (error) {
            result.innerHTML = `âŒ ERROR: ${error.message}`;
        }
    }

    function checkCoordinates() {
        const result = document.getElementById('coordinates-check');
        result.style.display = 'block';

        if (typeof locations === 'undefined') {
            result.innerHTML = 'âŒ locations ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. ë¨¼ì € ìœ„ì˜ ì²´í¬ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”.';
            return;
        }

        let validCoords = 0;
        let invalidCoords = [];

        locations.forEach((item, index) => {
            const lat = Number(item.lat);
            const lng = Number(item.lng);

            if (!Number.isFinite(lat) || !Number.isFinite(lng)) {
                invalidCoords.push({
                    index: index,
                    name: item.name,
                    lat: item.lat,
                    lng: item.lng,
                    reason: 'NaN ë˜ëŠ” ë¬´í•œê°’'
                });
            } else if (lat < -90 || lat > 90 || lng < -180 || lng > 180) {
                invalidCoords.push({
                    index: index,
                    name: item.name,
                    lat: lat,
                    lng: lng,
                    reason: 'ì¢Œí‘œ ë²”ìœ„ ì´ˆê³¼'
                });
            } else {
                validCoords++;
            }
        });

        result.innerHTML = `âœ… ìœ íš¨í•œ ì¢Œí‘œ: ${validCoords}ê°œ
âŒ ë¬´íš¨í•œ ì¢Œí‘œ: ${invalidCoords.length}ê°œ

${invalidCoords.length > 0 ? 'ë¬´íš¨í•œ ì¢Œí‘œ ëª©ë¡:\n' + JSON.stringify(invalidCoords, null, 2) : ''}`;
    }

    function traceMarkerCreation() {
        const result = document.getElementById('marker-trace');
        result.style.display = 'block';

        if (typeof naver === 'undefined' || !naver.maps) {
            result.innerHTML = 'âŒ ë„¤ì´ë²„ ì§€ë„ APIê°€ ë¡œë“œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.';
            return;
        }

        if (typeof locations === 'undefined') {
            result.innerHTML = 'âŒ locations ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.';
            return;
        }

        let traceLog = 'ë§ˆì»¤ ìƒì„± ê³¼ì • ì¶”ì :\n\n';
        let markerCount = 0;

        try {
            locations.forEach((item, index) => {
                traceLog += `[${index}] ${item.name}\n`;

                const lat = Number(item.lat);
                const lng = Number(item.lng);

                traceLog += `  - lat: ${lat}, lng: ${lng}\n`;

                if (!Number.isFinite(lat) || !Number.isFinite(lng)) {
                    traceLog += `  âŒ ì¢Œí‘œê°’ ë¬´íš¨ - ë§ˆì»¤ ìƒì„± ê±´ë„ˆëœ€\n\n`;
                    return;
                }

                try {
                    const position = new naver.maps.LatLng(lat, lng);
                    traceLog += `  âœ… LatLng ê°ì²´ ìƒì„± ì„±ê³µ\n`;

                    // ì‹¤ì œ ì§€ë„ê°€ ìˆëŠ”ì§€ í™•ì¸
                    if (window.naverMap) {
                        traceLog += `  âœ… ì§€ë„ ê°ì²´ ì¡´ì¬\n`;
                        markerCount++;
                    } else {
                        traceLog += `  âŒ ì§€ë„ ê°ì²´ ì—†ìŒ\n`;
                    }

                } catch (markerError) {
                    traceLog += `  âŒ ë§ˆì»¤ ìƒì„± ì‹¤íŒ¨: ${markerError.message}\n`;
                }

                traceLog += `\n`;
            });

            traceLog += `\nì´ ${markerCount}ê°œì˜ ë§ˆì»¤ê°€ ìƒì„±ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.`;

            if (window.mapMarkers) {
                traceLog += `\nì‹¤ì œ ìƒì„±ëœ ë§ˆì»¤: ${window.mapMarkers.length}ê°œ`;
            }

        } catch (error) {
            traceLog += `\nâŒ ERROR: ${error.message}`;
        }

        result.innerHTML = traceLog;
    }

    function checkMapBounds() {
        const result = document.getElementById('bounds-check');
        result.style.display = 'block';

        if (!window.naverMap) {
            result.innerHTML = 'âŒ ì§€ë„ ê°ì²´ê°€ ì—†ìŠµë‹ˆë‹¤.';
            return;
        }

        try {
            const center = window.naverMap.getCenter();
            const zoom = window.naverMap.getZoom();
            const bounds = window.naverMap.getBounds();

            result.innerHTML = `ì§€ë„ ìƒíƒœ ì •ë³´:

ì¤‘ì‹¬ì : ${center.lat()}, ${center.lng()}
ì¤Œ ë ˆë²¨: ${zoom}
ì§€ë„ ê²½ê³„:
  - ë¶ë™: ${bounds.getNE().lat()}, ${bounds.getNE().lng()}
  - ë‚¨ì„œ: ${bounds.getSW().lat()}, ${bounds.getSW().lng()}

ë§ˆì»¤ë“¤ì´ ì´ ë²”ìœ„ ì•ˆì— ìˆëŠ”ì§€ í™•ì¸í•´ë³´ì„¸ìš”!

ğŸ’¡ TIP: ì¤Œ ë ˆë²¨ì´ ë„ˆë¬´ ë†’ìœ¼ë©´ (15 ì´ìƒ) ë§ˆì»¤ë“¤ì´ ë³´ì´ì§€ ì•Šì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.`;

        } catch (error) {
            result.innerHTML = `âŒ ERROR: ${error.message}`;
        }
    }

    function createTestMarker() {
        const result = document.getElementById('test-marker-result');
        result.style.display = 'block';

        if (!window.naverMap) {
            result.innerHTML = 'âŒ ì§€ë„ ê°ì²´ê°€ ì—†ìŠµë‹ˆë‹¤.';
            return;
        }

        try {
            // ì§€ë„ ì¤‘ì‹¬ì— í…ŒìŠ¤íŠ¸ ë§ˆì»¤ ìƒì„±
            const center = window.naverMap.getCenter();

            const testMarker = new naver.maps.Marker({
                position: center,
                map: window.naverMap,
                title: 'í…ŒìŠ¤íŠ¸ ë§ˆì»¤',
                icon: {
                    content: `<div style="background: red; color: white; padding: 5px 10px; border-radius: 15px; font-weight: bold;">TEST</div>`,
                    anchor: new naver.maps.Point(25, 25)
                }
            });

            testMarkers.push(testMarker);

            result.innerHTML = `âœ… í…ŒìŠ¤íŠ¸ ë§ˆì»¤ ìƒì„± ì„±ê³µ!
ìœ„ì¹˜: ${center.lat()}, ${center.lng()}

ì§€ë„ì— ë¹¨ê°„ìƒ‰ "TEST" ë§ˆì»¤ê°€ ë³´ì´ë‚˜ìš”?
- ë³´ì¸ë‹¤ë©´: ë§ˆì»¤ ìƒì„±ì€ ì •ìƒ, ë°ì´í„° ë¬¸ì œì¼ ê°€ëŠ¥ì„±
- ì•ˆ ë³´ì¸ë‹¤ë©´: ì§€ë„ë‚˜ ë§ˆì»¤ API ë¬¸ì œì¼ ê°€ëŠ¥ì„±`;

        } catch (error) {
            result.innerHTML = `âŒ í…ŒìŠ¤íŠ¸ ë§ˆì»¤ ìƒì„± ì‹¤íŒ¨: ${error.message}`;
        }
    }

    function clearTestMarkers() {
        testMarkers.forEach(marker => {
            marker.setMap(null);
        });
        testMarkers = [];

        const result = document.getElementById('test-marker-result');
        if (result.style.display === 'block') {
            result.innerHTML += '\n\nğŸ§¹ í…ŒìŠ¤íŠ¸ ë§ˆì»¤ê°€ ì œê±°ë˜ì—ˆìŠµë‹ˆë‹¤.';
        }
    }

    // ìë™ìœ¼ë¡œ í•´ê²°ë°©ì•ˆ í‘œì‹œ
    function showSolutions() {
        const solutions = document.getElementById('solutions');
        solutions.innerHTML = `
                <div class="solution">
                    <h3>ğŸ” ê°€ì¥ ê°€ëŠ¥ì„± ë†’ì€ ì›ì¸ë“¤:</h3>

                    <h4>1. ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© ìˆœì„œ ë¬¸ì œ</h4>
                    <p>ë„¤ì´ë²„ ì§€ë„ APIê°€ ì™„ì „íˆ ë¡œë“œë˜ê¸° ì „ì— ë§ˆì»¤ ìƒì„± ì½”ë“œê°€ ì‹¤í–‰ë˜ì—ˆì„ ê°€ëŠ¥ì„±</p>
                    <strong>í•´ê²°:</strong>
                    <pre>// í˜„ì¬ ì½”ë“œì˜ checkNaverMapsAPI() í•¨ìˆ˜ í™•ì¸
function checkNaverMapsAPI() {
    if (typeof naver !== 'undefined' && naver.maps && naver.maps.Map) {
        console.log('ë„¤ì´ë²„ ì§€ë„ API ë¡œë“œ ì™„ë£Œ');
        initializeMap();
    } else {
        console.log('ë„¤ì´ë²„ ì§€ë„ API ëŒ€ê¸° ì¤‘...');
        setTimeout(checkNaverMapsAPI, 100);
    }
}</pre>

                    <h4>2. ë°ì´í„° íƒ€ì… ë¬¸ì œ</h4>
                    <p>ì¢Œí‘œê°’ì´ ë¬¸ìì—´ë¡œ ì „ë‹¬ë˜ì–´ Number() ë³€í™˜ì´ ì œëŒ€ë¡œ ì•ˆ ë˜ëŠ” ê²½ìš°</p>
                    <strong>í•´ê²°:</strong>
                    <pre>// ë” ì—„ê²©í•œ ì¢Œí‘œ ê²€ì¦
const lat = parseFloat(item.lat);
const lng = parseFloat(item.lng);

console.log(\`ì¢Œí‘œ í™•ì¸: \${item.name} - lat: \${lat}, lng: \${lng}\`);

if (isNaN(lat) || isNaN(lng)) {
    console.error('ì¢Œí‘œê°’ ì˜¤ë¥˜:', item);
    return;
}</pre>

                    <h4>3. activate í•„í„°ë§ ë¬¸ì œ</h4>
                    <p>ë°ì´í„°ë² ì´ìŠ¤ì˜ activate í•„ë“œê°€ falseë¡œ ë˜ì–´ìˆì„ ê°€ëŠ¥ì„±</p>
                    <strong>í™•ì¸:</strong> RestLocationController.javaì˜ .filter(Location::isActivate) ë¶€ë¶„

                    <h4>4. CSS z-index ë¬¸ì œ</h4>
                    <p>ë§ˆì»¤ê°€ ìƒì„±ë˜ì—ˆì§€ë§Œ ë‹¤ë¥¸ ìš”ì†Œì— ê°€ë ¤ì ¸ ë³´ì´ì§€ ì•ŠëŠ” ê²½ìš°</p>
                    <strong>í•´ê²°:</strong> ê°œë°œìë„êµ¬ì—ì„œ Elements íƒ­ìœ¼ë¡œ ë§ˆì»¤ DOM ìš”ì†Œ ì¡´ì¬ ì—¬ë¶€ í™•ì¸
                </div>

                <div class="solution">
                    <h3>ğŸ› ï¸ ì¦‰ì‹œ ì‹œë„í•´ë³¼ ìˆ˜ ìˆëŠ” í•´ê²°ì±…:</h3>

                    <h4>ë°©ë²• 1: ë¸Œë¼ìš°ì € ìƒˆë¡œê³ ì¹¨</h4>
                    <p>Ctrl+F5 (ê°•ì œ ìƒˆë¡œê³ ì¹¨)ìœ¼ë¡œ ìºì‹œë¥¼ ë¬´ì‹œí•˜ê³  ìƒˆë¡œê³ ì¹¨</p>

                    <h4>ë°©ë²• 2: ì½˜ì†”ì—ì„œ ì§ì ‘ í™•ì¸</h4>
                    <p>F12 ê°œë°œìë„êµ¬ â†’ Console íƒ­ì—ì„œ ì‹¤í–‰:</p>
                    <pre>console.log('locations:', locations);
console.log('naverMap:', window.naverMap);
console.log('markers:', window.mapMarkers);</pre>

                    <h4>ë°©ë²• 3: ìˆ˜ë™ ë§ˆì»¤ ìƒì„± í…ŒìŠ¤íŠ¸</h4>
                    <p>Consoleì—ì„œ ì‹¤í–‰:</p>
                    <pre>new naver.maps.Marker({
    position: new naver.maps.LatLng(37.4327975, 127.1353342),
    map: window.naverMap,
    title: 'í…ŒìŠ¤íŠ¸'
});</pre>
                </div>`;
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ í•´ê²°ë°©ì•ˆ í‘œì‹œ
    document.addEventListener('DOMContentLoaded', showSolutions);
</script>
</body>
</html>